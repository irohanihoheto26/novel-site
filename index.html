// 全体一覧（詳細表示機能付き）
    async function getList() {
        const { data: novels } = await api.from('novels').select('*').order('created_at', { ascending: false });
        const { data: allLikes } = await api.from('likes').select('novel_id');
        
        const listDiv = document.getElementById('list');
        listDiv.innerHTML = novels.map(n => {
            const likeCount = allLikes ? allLikes.filter(l => l.novel_id === n.id).length : 0;

            return `
                <div class="novel-card">
                    <h3 onclick="toggleContent('${n.id}')" style="cursor:pointer; text-decoration:underline;">${n.title}</h3>
                    <div class="author-info">
                        by ${n.author_name} 
                        <button class="text-btn" onclick="addFav('${n.author_id}')">お気に入り作者に追加</button>
                    </div>
                    <div class="caption">${n.caption || ''}</div>
                    
                    <div id="content-${n.id}" class="hidden" style="white-space:pre-wrap; background:#f0f0f0; padding:20px; margin:15px 0; border-top:1px solid #000;">${n.content}</div>
                    
                    <button class="heart" onclick="addLike('${n.id}')">♥ ${likeCount}</button>
                </div>
            `;
        }).join('');
    }

    // 本文の表示・非表示を切り替える
    function toggleContent(id) {
        const target = document.getElementById('content-' + id);
        target.classList.toggle('hidden');
    }
